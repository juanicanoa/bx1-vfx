<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bx1 Vfx - Portfolio</title>
<link rel="icon" type="image/png" href="assets/logo.png">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<style>
:root {
  --bg-primary: #0b0b0b;
  --bg-secondary: rgba(255,255,255,0.05);
  --text-primary: #fff;
  --text-secondary: rgba(255,255,255,0.7);
  --accent: rgba(255,255,255,.3);
  --glow: rgba(255,255,255,.2);
  --primary-color: #64c8ff;
  --gradient: linear-gradient(135deg, #64c8ff, #8b5cf6);
}

body.light-mode {
  --bg-primary: #f5f5f5;
  --bg-secondary: rgba(0,0,0,0.05);
  --text-primary: #1a1a1a;
  --text-secondary: rgba(0,0,0,0.7);
  --accent: rgba(0,0,0,.2);
  --glow: rgba(0,0,0,.1);
  --primary-color: #0066cc;
}
</style>
<style>
*{ box-sizing:border-box; }

body{
  margin:0;
  font-family:'Inter',sans-serif;
  color: var(--text-primary);
  background: var(--bg-primary);
  overflow-x:hidden;
  transition: background 0.3s ease, color 0.3s ease;
  padding-top: 80px;
}

body:not(.light-mode) {
  background:
    radial-gradient(circle at 20% 30%, #ffffff22, transparent 40%),
    radial-gradient(circle at 80% 70%, #ffffff11, transparent 45%),
    #0b0b0b;
}

/* ===== MENÚ SUPERIOR ===== */
.navbar {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  background: rgba(11, 11, 11, 0.95);
  backdrop-filter: blur(20px);
  border-bottom: 1px solid rgba(100, 200, 255, 0.2);
  z-index: 1000;
  padding: 15px 0;
}

.light-mode .navbar {
  background: rgba(245, 245, 245, 0.95);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.logo {
  font-size: 1.5rem;
  font-weight: 900;
  color: var(--text-primary);
  display: flex;
  align-items: center;
  gap: 10px;
  text-decoration: none;
}

.logo i {
  color: var(--primary-color);
}

.nav-menu {
  display: flex;
  gap: 5px;
  align-items: center;
}

.nav-btn {
  padding: 10px 20px;
  border: none;
  background: transparent;
  color: var(--text-secondary);
  font-weight: 600;
  font-size: 0.9rem;
  border-radius: 30px;
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  gap: 8px;
  text-decoration: none;
}

.nav-btn:hover {
  background: rgba(100, 200, 255, 0.1);
  color: var(--text-primary);
}

.nav-btn.active {
  background: rgba(100, 200, 255, 0.2);
  color: var(--primary-color);
}

.theme-toggle-nav {
  background: rgba(100, 200,255, 0.1);
  border: 1px solid rgba(100, 200,255, 0.3);
  border-radius: 30px;
  padding: 10px 15px;
  cursor: pointer;
  font-weight: 600;
  color: var(--text-primary);
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 0.9rem;
  margin-left: 10px;
}

.theme-toggle-nav:hover {
  background: rgba(100, 200,255, 0.2);
}

.menu-toggle {
  display: none;
  background: transparent;
  border: none;
  color: var(--text-primary);
  font-size: 1.5rem;
  cursor: pointer;
}

@media (max-width: 992px) {
  .menu-toggle {
    display: block;
  }
  
  .nav-menu {
    position: fixed;
    top: 70px;
    left: 0;
    width: 100%;
    background: var(--bg-primary);
    flex-direction: column;
    padding: 20px;
    gap: 10px;
    transform: translateY(-100%);
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
  }
  
  .nav-menu.active {
    transform: translateY(0);
    opacity: 1;
    visibility: visible;
  }
  
  body {
    padding-top: 70px;
  }
}

/* ===== GALERÍA DINÁMICA ===== */
.gallery-section {
  padding: 60px 20px;
  max-width: 1400px;
  margin: 0 auto;
}

.gallery-header {
  text-align: center;
  margin-bottom: 50px;
}

.gallery-header h2 {
  font-size: 2.5rem;
  font-weight: 900;
  margin-bottom: 15px;
}

.gallery-header p {
  color: var(--text-secondary);
  font-size: 1.1rem;
  max-width: 600px;
  margin: 0 auto;
}

/* PESTAÑAS */
.gallery-tabs {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin-bottom: 40px;
  flex-wrap: wrap;
}

.gallery-tab {
  padding: 12px 30px;
  background: transparent;
  border: 2px solid var(--accent);
  color: var(--text-secondary);
  border-radius: 30px;
  font-weight: 700;
  font-size: 0.9rem;
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  gap: 10px;
}

.gallery-tab:hover {
  background: rgba(100, 200, 255, 0.1);
  color: var(--text-primary);
}

.gallery-tab.active {
  background: var(--gradient);
  color: white;
  border-color: transparent;
  box-shadow: 0 5px 20px rgba(100, 200, 255, 0.3);
}

/* GRID PRINCIPAL */
.gallery-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
  gap: 30px;
  margin-bottom: 50px;
}

.gallery-item {
  background: var(--bg-secondary);
  border-radius: 20px;
  overflow: hidden;
  transition: all 0.4s ease;
  border: 1px solid var(--accent);
  animation: fadeInUp 0.6s ease;
}

.gallery-item:hover {
  transform: translateY(-10px);
  box-shadow: 0 20px 40px rgba(0,0,0,0.4);
  border-color: var(--primary-color);
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* SLIDER PORTADAS */
.cover-slider {
  position: relative;
  width: 100%;
  height: 250px;
  overflow: hidden;
}

.slide-container {
  width: 200%;
  height: 100%;
  display: flex;
  transition: transform 0.5s ease;
}

.slide {
  width: 50%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

.slide img {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
  border-radius: 10px;
  box-shadow: 0 5px 15px rgba(0,0,0,0.3);
}

.slider-controls {
  position: absolute;
  bottom: 15px;
  left: 0;
  width: 100%;
  display: flex;
  justify-content: center;
  gap: 10px;
  z-index: 2;
}

.slider-btn {
  background: rgba(0,0,0,0.7);
  border: none;
  color: white;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}

.slider-btn:hover {
  background: rgba(100,200,255,0.8);
}

.slide-indicator {
  position: absolute;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0,0,0,0.7);
  color: white;
  padding: 5px 15px;
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: 600;
}

/* CONTENIDO DE GALERÍA */
.gallery-content {
  padding: 20px;
}

.gallery-content h3 {
  margin: 0 0 10px 0;
  font-size: 1.3rem;
}

.gallery-content p {
  margin: 0 0 15px 0;
  color: var(--text-secondary);
  font-size: 0.9rem;
  line-height: 1.5;
}

.gallery-tags {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  margin-bottom: 15px;
}

.tag {
  background: rgba(100,200,255,0.1);
  color: var(--primary-color);
  padding: 5px 12px;
  border-radius: 15px;
  font-size: 0.8rem;
  font-weight: 600;
}

.gallery-actions {
  display: flex;
  gap: 10px;
}

.action-btn {
  flex: 1;
  padding: 10px;
  border-radius: 10px;
  border: none;
  font-weight: 700;
  font-size: 0.9rem;
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.primary-btn {
  background: var(--gradient);
  color: white;
}

.primary-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(100,200,255,0.3);
}

.secondary-btn {
  background: transparent;
  border: 2px solid var(--accent);
  color: var(--text-primary);
}

.secondary-btn:hover {
  background: rgba(100,200,255,0.1);
}

/* ESTADO VACÍO */
.empty-state {
  grid-column: 1 / -1;
  text-align: center;
  padding: 80px 20px;
  color: var(--text-secondary);
}

.empty-state i {
  font-size: 4rem;
  margin-bottom: 20px;
  opacity: 0.3;
}

.empty-state h3 {
  color: var(--text-primary);
  margin-bottom: 10px;
}

/* FOOTER */
footer{
  text-align:center;
  padding:40px 20px;
  font-size:.9rem;
  opacity:.6;
  margin-top: 60px;
  border-top: 1px solid var(--accent);
}

/* LOGIN MODAL */
.login-modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.9);
  backdrop-filter: blur(10px);
  z-index: 9999;
  align-items: center;
  justify-content: center;
}

.login-content {
  background: var(--bg-primary);
  padding: 40px;
  border-radius: 20px;
  border: 2px solid var(--primary-color);
  max-width: 400px;
  width: 90%;
  text-align: center;
}

.login-content h3 {
  margin-bottom: 30px;
  font-size: 1.5rem;
}

.login-input {
  width: 100%;
  padding: 12px;
  margin-bottom: 15px;
  background: rgba(255,255,255,0.1);
  border: 1px solid var(--accent);
  border-radius: 10px;
  color: var(--text-primary);
  font-size: 1rem;
}

.login-btn {
  width: 100%;
  padding: 12px;
  background: var(--gradient);
  color: white;
  border: none;
  border-radius: 10px;
  font-weight: 700;
  cursor: pointer;
  margin-bottom: 15px;
  font-size: 1rem;
}

.login-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(100,200,255,0.3);
}

.cancel-btn {
  width: 100%;
  padding: 12px;
  background: transparent;
  border: 2px solid var(--accent);
  color: var(--text-primary);
  border-radius: 10px;
  font-weight: 700;
  cursor: pointer;
}

.error-message {
  color: #ff4444;
  margin-top: 15px;
  display: none;
}

/* ADMIN BUTTON */
.admin-btn {
  position: fixed;
  bottom: 100px;
  right: 30px;
  z-index: 1000;
  background: var(--gradient);
  color: white;
  border: none;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  box-shadow: 0 5px 15px rgba(100,200,255,0.3);
  transition: all 0.3s ease;
}

.admin-btn:hover {
  transform: scale(1.1);
}
</style>
</head>

<body>

<nav class="navbar">
  <div class="nav-container">
    <a href="index.html" class="logo">
      <i class="fas fa-film"></i>
      <span>Bx1 Vfx</span>
    </a>
    
    <button class="menu-toggle" onclick="toggleMenu()">
      <i class="fas fa-bars"></i>
    </button>
    
    <div class="nav-menu" id="navMenu">
      <a href="index.html" class="nav-btn">
        <i class="fas fa-home"></i> INICIO
      </a>
      <a href="index.html#portadas" class="nav-btn">
        <i class="fas fa-image"></i> PORTADAS
      </a>
      <a href="index.html#video" class="nav-btn">
        <i class="fas fa-video"></i> VIDEOS
      </a>
      <a href="works.html" class="nav-btn active">
        <i class="fas fa-briefcase"></i> WORKS
      </a>
      <a href="index.html#faq" class="nav-btn">
        <i class="fas fa-question-circle"></i> FAQ
      </a>
      
      <button class="theme-toggle-nav" onclick="toggleTheme()" id="themeToggleNav">
        <i class="fas fa-moon"></i> Modo Oscuro
      </button>
    </div>
  </div>
</nav>

<!-- BOTÓN ADMIN FLOTANTE -->
<button class="admin-btn" id="adminButton" style="display: none;" onclick="showLogin()">
  <i class="fas fa-user-shield"></i>
</button>

<!-- MODAL DE LOGIN -->
<div class="login-modal" id="loginModal">
  <div class="login-content">
    <h3><i class="fas fa-lock"></i> Acceso Administrador</h3>
    <input type="email" id="adminEmail" class="login-input" placeholder="Email" autocomplete="username">
    <input type="password" id="adminPassword" class="login-input" placeholder="Contraseña" autocomplete="current-password">
    <button class="login-btn" onclick="adminLogin()">
      <i class="fas fa-sign-in-alt"></i> Iniciar Sesión
    </button>
    <button class="cancel-btn" onclick="hideLogin()">
      Cancelar
    </button>
    <div class="error-message" id="loginError">
      <i class="fas fa-exclamation-circle"></i> Credenciales incorrectas
    </div>
  </div>
</div>

<div class="gallery-section">
  <div class="gallery-header">
    <h2><i class="fas fa-briefcase"></i> PORTFOLIO</h2>
    <p>Trabajos más recientes y destacados</p>
  </div>
  
  <div class="gallery-tabs">
    <button class="gallery-tab active" onclick="showGallery('portadas')">
      <i class="fas fa-image"></i> Portadas
    </button>
    <button class="gallery-tab" onclick="showGallery('videos')">
      <i class="fas fa-video"></i> Videos
    </button>
    
    <!-- SOLO VISIBLE PARA ADMINS -->
    <div id="adminTab" style="display: none;">
      <a href="admin.html" class="gallery-tab" style="text-decoration: none; color: inherit;">
        <i class="fas fa-upload"></i> Subir Portadas
      </a>
    </div>
  </div>
  
  <!-- GALERÍA DINÁMICA DE PORTADAS -->
  <div class="gallery-grid" id="portadasGrid">
    <!-- Las portadas se cargarán aquí desde Supabase -->
  </div>
  
  <!-- GALERÍA DE VIDEOS (temporal) -->
  <div class="gallery-grid" id="videosGrid" style="display: none;">
    <!-- Videos se cargarán aquí -->
  </div>
  
  <div style="text-align:center; margin-top:60px;">
    <h3 style="color: var(--text-primary); margin-bottom:20px;">¿Te gustó nuestro trabajo?</h3>
    <p style="color: var(--text-secondary); margin-bottom:30px;">Contáctanos para tu próximo proyecto</p>
    <div style="display:flex; gap:15px; justify-content:center; flex-wrap:wrap;">
      <a href="https://wa.me/5492634352381" target="_blank" style="padding:12px 30px; background:#25d366; color:white; text-decoration:none; border-radius:12px; font-weight:700; display:flex; align-items:center; gap:10px;">
        <i class="fab fa-whatsapp"></i> WhatsApp
      </a>
      <a href="https://www.instagram.com/bx1.vfx?igsh=Z3I5eWtwNnplaHRo" target="_blank" style="padding:12px 30px; background:linear-gradient(45deg,#E1306C,#FD1D1D); color:white; text-decoration:none; border-radius:12px; font-weight:700; display:flex; align-items:center; gap:10px;">
        <i class="fab fa-instagram"></i> Instagram
      </a>
    </div>
  </div>
</div>

<footer>
    <p>© 2024 Bx1 Vfx - Portfolio</p>
    <a href="index.html" style="color: var(--primary-color); text-decoration:none; margin-top:10px; display:inline-block;">
      <i class="fas fa-arrow-left"></i> Volver a Servicios
    </a>
</footer>

<!-- SUPABASE CONFIGURADO PARA BX1 VFX -->
<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<script>
// ===== CONFIGURACIÓN SUPABASE =====
// DATOS DE BX1 VFX - CONFIGURADOS
const SUPABASE_URL = 'https://vblqhgfcupeoeymgbxrv.supabase.co';
const SUPABASE_KEY = 'sb_publishable_bWp5XCGeO2HHByfoDCEfCg_hGrXMQxc';
const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

// ===== VARIABLES GLOBALES =====
let slidePositions = {};
let isAdmin = false;
let currentUser = null;

// ===== FUNCIONES DE AUTENTICACIÓN =====

// Verificar si el usuario es admin
async function checkAdmin() {
  try {
    const { data: { user }, error } = await supabase.auth.getUser();
    
    if (error || !user) {
      isAdmin = false;
      currentUser = null;
      updateUI();
      return false;
    }
    
    // Verificar en tabla de admins
    const { data: adminData, error: adminError } = await supabase
      .from('admins')
      .select('*')
      .eq('user_id', user.id)
      .single();
    
    if (adminData && !adminError) {
      isAdmin = true;
      currentUser = user;
      updateUI();
      return true;
    }
    
    isAdmin = false;
    currentUser = user;
    updateUI();
    return false;
    
  } catch (error) {
    console.error('Error verificando admin:', error);
    isAdmin = false;
    currentUser = null;
    updateUI();
    return false;
  }
}

// Actualizar UI según permisos
function updateUI() {
  const adminTab = document.getElementById('adminTab');
  const adminButton = document.getElementById('adminButton');
  
  if (isAdmin) {
    // Mostrar botón y pestaña de admin
    if (adminTab) adminTab.style.display = 'block';
    if (adminButton) {
      adminButton.style.display = 'flex';
      adminButton.innerHTML = '<i class="fas fa-user-shield"></i>';
      adminButton.onclick = () => window.location.href = 'admin.html';
    }
  } else {
    // Ocultar pestaña de admin
    if (adminTab) adminTab.style.display = 'none';
    
    // Mostrar botón de login si no está logueado
    if (adminButton) {
      adminButton.style.display = currentUser ? 'none' : 'flex';
      adminButton.innerHTML = '<i class="fas fa-lock"></i>';
      adminButton.onclick = showLogin;
    }
  }
}

// Mostrar modal de login
function showLogin() {
  document.getElementById('loginModal').style.display = 'flex';
  document.getElementById('loginError').style.display = 'none';
  document.getElementById('adminEmail').focus();
}

// Ocultar modal de login
function hideLogin() {
  document.getElementById('loginModal').style.display = 'none';
  document.getElementById('adminEmail').value = '';
  document.getElementById('adminPassword').value = '';
}

// Login de admin
async function adminLogin() {
  const email = document.getElementById('adminEmail').value.trim();
  const password = document.getElementById('adminPassword').value;
  
  if (!email || !password) {
    document.getElementById('loginError').textContent = 'Por favor, completa todos los campos';
    document.getElementById('loginError').style.display = 'block';
    return;
  }
  
  try {
    const { data, error } = await supabase.auth.signInWithPassword({
      email: email,
      password: password
    });
    
    if (error) {
      document.getElementById('loginError').textContent = error.message;
      document.getElementById('loginError').style.display = 'block';
      return;
    }
    
    // Verificar si es admin
    const { data: adminData } = await supabase
      .from('admins')
      .select('*')
      .eq('user_id', data.user.id)
      .single();
    
    if (!adminData) {
      // No es admin, cerrar sesión
      await supabase.auth.signOut();
      document.getElementById('loginError').textContent = 'No tienes permisos de administrador';
      document.getElementById('loginError').style.display = 'block';
      return;
    }
    
    // Éxito
    hideLogin();
    isAdmin = true;
    currentUser = data.user;
    updateUI();
    cargarPortadas(); // Recargar portadas
    
  } catch (error) {
    console.error('Error en login:', error);
    document.getElementById('loginError').textContent = 'Error del servidor';
    document.getElementById('loginError').style.display = 'block';
  }
}

// Logout
async function adminLogout() {
  await supabase.auth.signOut();
  isAdmin = false;
  currentUser = null;
  updateUI();
  cargarPortadas();
}

// ===== FUNCIONES PRINCIPALES =====

// Mostrar sección de galería
function showGallery(tab) {
  // Actualizar pestañas activas
  document.querySelectorAll('.gallery-tab').forEach(btn => {
    btn.classList.remove('active');
  });
  event.target.classList.add('active');
  
  // Mostrar/ocultar galerías
  if (tab === 'portadas') {
    document.getElementById('portadasGrid').style.display = 'grid';
    document.getElementById('videosGrid').style.display = 'none';
  } else if (tab === 'videos') {
    document.getElementById('portadasGrid').style.display = 'none';
    document.getElementById('videosGrid').style.display = 'grid';
    cargarVideos();
  }
}

// Cargar portadas desde Supabase
async function cargarPortadas() {
  try {
    const { data: portadas, error } = await supabase
      .from('portadas')
      .select('*')
      .order('created_at', { ascending: false });
    
    if (error) {
      console.error('Error cargando portadas:', error);
      mostrarError();
      return;
    }
    
    mostrarPortadas(portadas || []);
    
  } catch (error) {
    console.error('Error:', error);
    mostrarError();
  }
}

// Mostrar portadas en la galería
function mostrarPortadas(portadas) {
  const container = document.getElementById('portadasGrid');
  
  if (!portadas || portadas.length === 0) {
    container.innerHTML = `
      <div class="empty-state">
        <i class="fas fa-images"></i>
        <h3>No hay portadas aún</h3>
        <p>${isAdmin ? 'Usa el panel de administración para subir portadas' : 'Próximamente se mostrarán aquí los trabajos'}</p>
        ${isAdmin ? `
          <a href="admin.html" style="display: inline-block; margin-top: 20px; padding: 12px 30px; background: var(--gradient); color: white; text-decoration: none; border-radius: 12px; font-weight: 700;">
            <i class="fas fa-upload"></i> Ir al Panel de Administración
          </a>
        ` : ''}
      </div>
    `;
    return;
  }
  
  let html = '';
  let index = 0;
  
  portadas.forEach(portada => {
    const slideId = `slide${index + 1}`;
    slidePositions[slideId] = 0;
    
    const categoriaNombre = getCategoryName(portada.categoria);
    
    if (portada.tiene_contratapa && portada.imagen_contratapa_url) {
      // Portada con slider (tapa + contratapa)
      html += `
        <div class="gallery-item" data-category="${portada.categoria}">
          <div class="cover-slider">
            <div class="slide-container" id="${slideId}">
              <div class="slide">
                <img src="${portada.imagen_url}" alt="${portada.nombre}" loading="lazy">
              </div>
              <div class="slide">
                <img src="${portada.imagen_contratapa_url}" alt="${portada.nombre_contratapa || 'Contratapa'}" loading="lazy">
              </div>
            </div>
            <div class="slider-controls">
              <button class="slider-btn" onclick="prevSlide('${slideId}')">
                <i class="fas fa-chevron-left"></i>
              </button>
              <div class="slide-indicator">1/2</div>
              <button class="slider-btn" onclick="nextSlide('${slideId}')">
                <i class="fas fa-chevron-right"></i>
              </button>
            </div>
          </div>
          <div class="gallery-content">
            <h3>${portada.nombre}</h3>
            <p>${portada.descripcion || 'Sin descripción'}</p>
            <div class="gallery-tags">
              <span class="tag">${categoriaNombre}</span>
              ${(portada.etiquetas || []).map(tag => `<span class="tag">${tag}</span>`).join('')}
            </div>
            <div class="gallery-actions">
              <button class="action-btn primary-btn" onclick="window.location.href='index.html#portadas'">
                <i class="fas fa-shopping-cart"></i> Contratar
              </button>
            </div>
          </div>
        </div>`;
    } else {
      // Portada simple
      html += `
        <div class="gallery-item" data-category="${portada.categoria}">
          <div class="cover-slider">
            <div class="slide-container" id="${slideId}">
              <div class="slide">
                <img src="${portada.imagen_url}" alt="${portada.nombre}" loading="lazy">
              </div>
            </div>
            <div class="slide-indicator">${categoriaNombre}</div>
          </div>
          <div class="gallery-content">
            <h3>${portada.nombre}</h3>
            <p>${portada.descripcion || 'Sin descripción'}</p>
            <div class="gallery-tags">
              <span class="tag">${categoriaNombre}</span>
              ${(portada.etiquetas || []).map(tag => `<span class="tag">${tag}</span>`).join('')}
            </div>
            <div class="gallery-actions">
              <button class="action-btn primary-btn" onclick="window.location.href='index.html#portadas'">
                <i class="fas fa-shopping-cart"></i> Contratar
              </button>
            </div>
          </div>
        </div>`;
    }
    
    index++;
  });
  
  container.innerHTML = html;
}

// Mostrar error
function mostrarError() {
  const container = document.getElementById('portadasGrid');
  container.innerHTML = `
    <div class="empty-state">
      <i class="fas fa-exclamation-triangle"></i>
      <h3>Error al cargar las portadas</h3>
      <p>Intenta recargar la página</p>
      <button class="action-btn primary-btn" style="margin-top: 20px;" onclick="cargarPortadas()">
        <i class="fas fa-sync-alt"></i> Reintentar
      </button>
    </div>
  `;
}

// Obtener nombre legible de categoría
function getCategoryName(category) {
  const categories = {
    'album': 'Álbum',
    'single': 'Single',
    'ep': 'EP',
    'banner': 'Banner',
    'diseño': 'Diseño Personalizado'
  };
  return categories[category] || category;
}

// Funciones del slider
function nextSlide(slideId) {
  const container = document.getElementById(slideId);
  if (!container) return;
  
  const totalSlides = container.children.length;
  const currentPosition = slidePositions[slideId] || 0;
  
  slidePositions[slideId] = (currentPosition + 1) % totalSlides;
  container.style.transform = `translateX(-${slidePositions[slideId] * 50}%)`;
  
  const indicator = container.nextElementSibling.querySelector('.slide-indicator');
  if (indicator && totalSlides > 1) {
    indicator.textContent = `${slidePositions[slideId] + 1}/${totalSlides}`;
  }
}

function prevSlide(slideId) {
  const container = document.getElementById(slideId);
  if (!container) return;
  
  const totalSlides = container.children.length;
  const currentPosition = slidePositions[slideId] || 0;
  
  slidePositions[slideId] = (currentPosition - 1 + totalSlides) % totalSlides;
  container.style.transform = `translateX(-${slidePositions[slideId] * 50}%)`;
  
  const indicator = container.nextElementSibling.querySelector('.slide-indicator');
  if (indicator && totalSlides > 1) {
    indicator.textContent = `${slidePositions[slideId] + 1}/${totalSlides}`;
  }
}

// Cargar videos (temporal)
function cargarVideos() {
  const container = document.getElementById('videosGrid');
  container.innerHTML = `
    <div class="empty-state">
      <i class="fas fa-video-slash"></i>
      <h3>Próximamente</h3>
      <p>La galería de videos estará disponible en la próxima actualización</p>
      <p style="font-size: 0.9rem; margin-top: 10px;">Por ahora, visita nuestro <a href="https://www.youtube.com" target="_blank" style="color: var(--primary-color);">canal de YouTube</a></p>
    </div>
  `;
}

// ===== FUNCIONES DE TEMA Y MENÚ =====

function toggleMenu() {
  const navMenu = document.getElementById('navMenu');
  navMenu.classList.toggle('active');
}

function toggleTheme() {
  const body = document.body;
  const btn = document.getElementById('themeToggleNav');
  
  body.classList.toggle('light-mode');
  
  if (body.classList.contains('light-mode')) {
    btn.innerHTML = '<i class="fas fa-sun"></i> Modo Claro';
    localStorage.setItem('theme', 'light');
  } else {
    btn.innerHTML = '<i class="fas fa-moon"></i> Modo Oscuro';
    localStorage.setItem('theme', 'dark');
  }
}

// Cargar tema guardado
if (localStorage.getItem('theme') === 'light') {
  document.body.classList.add('light-mode');
  document.getElementById('themeToggleNav').innerHTML = '<i class="fas fa-sun"></i> Modo Claro';
}

// ===== INICIALIZACIÓN =====
document.addEventListener('DOMContentLoaded', async () => {
  // Verificar autenticación
  await checkAdmin();
  
  // Cargar portadas
  cargarPortadas();
  
  // Suscribirse a cambios en tiempo real
  supabase
    .channel('portadas-changes')
    .on('postgres_changes', { 
      event: '*', 
      schema: 'public', 
      table: 'portadas' 
    }, () => {
      cargarPortadas();
    })
    .subscribe();
});
</script>
</body>
</html>